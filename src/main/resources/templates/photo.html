<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" class="no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>图片分类</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<link rel="stylesheet" href="../css/animate.css">
	<link rel="stylesheet" href="../css/icomoon.css">
	<link rel="stylesheet" href="../css/bootstrap.css">
	<link rel="stylesheet" href="../css/font-awesome.min.css">
	<link rel="stylesheet" href="../css/ace.min.css">
	<link rel="stylesheet" href="../css/ace-skins.min.css">
	<link rel="stylesheet" href="../css/owl.carousel.min.css">
	<link rel="stylesheet" href="../css/owl.theme.default.min.css">
	<link rel="stylesheet" href="../css/style.css">

	<script src="../js/modernizr-2.6.2.min.js"></script>

	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="../js/respond.min.js"></script>
	<![endif]-->

	<style type="text/css">
		/* 去除div滚动条 */
		#fh5co-aside{
			overflow: hidden;
		}
		/* 顶部导航栏 */
		.navbar{
			background-color: #E6E6E6;
			width: 100%;
			height: 32px;
			position:fixed;
			/*margin-top: -32px;*/
			z-index:999; /* 让DIV显示最上层，数值越大，越在上 */
		}
		.user-info{
			font-size: small;
		}
		textarea{
			overflow:auto;
			border: none;
			resize:none;
			/* js修改颜色 */
			background-color: #E4E6E9;

		}
		/* 聚焦，点击文本域背景颜色 */
		textarea:focus{
			background-color: #E4E6E9;
		}
		/* DIV模拟文本域 */
		#classifyDescribe{
			/*padding: 3px;*/
			/*border: 1px solid #a0b3d6;*/
			font-family: 华文新魏;
			min-height: 100px;
			max-height: 100px;
			_height: 100px;
			margin-left: auto;
			margin-right: auto;
			outline: 0;
			font-size: 16px;
			word-wrap: break-word;
			overflow-x: hidden;
			overflow-y: auto;
			-webkit-user-modify: read-write-plaintext-only;
			/*overflow-y:hidden;*/  /* 隐藏DIV纵向滚动条 */
		}
		.head-font{
			font-family: 华文行楷;
			color: #0f0f0f;
			font-size: 50px;
		}
		#addClassifyOne{
			margin-left: 25px;
			text-decoration:none;/* 去下划线 */
		}
		#editClassify{
			/*float: left;*/
			bottom: 0px;
			height: 30px;
			width: 60px;
		}
		#deleteClassify{
			/*float: left;*/
			bottom: 0px;
			height: 30px;
			width: 60px;
		}
		.icon-edit{
			float: left;
			margin-top: -4px;
		}
		.icon-trash{
			float: left;
			margin-top: -4px;
		}
		.col-md-4{
			margin-bottom: 30px;
			/*border:1px solid #F00;*/
			/*margin-left: 1px;*/

		}
		.modal-content span{
			font-size: large;
			font-family: 华文行楷;
		}
	</style>
</head>
<body>
	<!-- 顶部导航 -->
	<div class="navbar navbar-default" id="navbar">
	<!-- 顶部右边下拉选择框 -->
		<div class="navbar-header pull-right" role="navigation">
			<ul class="nav ace-nav">

				<!-- 第一个下拉框 -->
				<li class="purple">
					<a data-toggle="dropdown" class="dropdown-toggle" href="#">
						<i class="icon-bell-alt icon-animated-bell"></i>
						<span class="badge badge-important">8</span>
					</a>

					<ul class="pull-right dropdown-navbar navbar-pink dropdown-menu dropdown-caret dropdown-close">
						<li class="dropdown-header">
							<i class="icon-warning-sign"></i>
							8条通知
						</li>

						<li>
							<a href="#">
								<div class="clearfix">
												<span class="pull-left">
													<i class="btn btn-xs no-hover btn-pink icon-comment"></i>
													新闻评论
												</span>
									<span class="pull-right badge badge-info">+12</span>
								</div>
							</a>
						</li>

						<li>
							<a href="#">
								<i class="btn btn-xs btn-primary icon-user"></i>
								切换为编辑登录..
							</a>
						</li>

						<li>
							<a href="#">
								<div class="clearfix">
												<span class="pull-left">
													<i class="btn btn-xs no-hover btn-success icon-shopping-cart"></i>
													新订单
												</span>
									<span class="pull-right badge badge-success">+8</span>
								</div>
							</a>
						</li>

						<li>
							<a href="#">
								<div class="clearfix">
												<span class="pull-left">
													<i class="btn btn-xs no-hover btn-info icon-twitter"></i>
													粉丝
												</span>
									<span class="pull-right badge badge-info">+11</span>
								</div>
							</a>
						</li>

						<li>
							<a href="#">
								查看所有通知
								<i class="icon-arrow-right"></i>
							</a>
						</li>
					</ul>
				</li>

				<!-- 第二个下拉框 -->
				<li class="green">
					<a data-toggle="dropdown" class="dropdown-toggle" href="#">
						<i class="icon-envelope icon-animated-vertical"></i>
						<span class="badge badge-success">5</span>
					</a>
					<ul class="pull-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close">
						<li class="dropdown-header">
							<i class="icon-envelope-alt"></i>
							5条消息
						</li>

						<li>
							<a href="#">
								<img src="../images/avatar.png" class="msg-photo" alt="Alex's Avatar" />
								<span class="msg-body">
												<span class="msg-title">
													<span class="blue">Alex:</span>
													不知道写啥 ...
												</span>

												<span class="msg-time">
													<i class="icon-time"></i>
													<span>1分钟以前</span>
												</span>
											</span>
							</a>
						</li>

						<li>
							<a href="#">
								<img src="../images/avatar3.png" class="msg-photo" alt="Susan's Avatar" />
								<span class="msg-body">
												<span class="msg-title">
													<span class="blue">Susan:</span>
													不知道翻译...
												</span>

												<span class="msg-time">
													<i class="icon-time"></i>
													<span>20分钟以前</span>
												</span>
											</span>
							</a>
						</li>

						<li>
							<a href="#">
								<img src="../images/avatar4.png" class="msg-photo" alt="Bob's Avatar" />
								<span class="msg-body">
												<span class="msg-title">
													<span class="blue">Bob:</span>
													到底是不是英文 ...
												</span>

												<span class="msg-time">
													<i class="icon-time"></i>
													<span>下午3:15</span>
												</span>
											</span>
							</a>
						</li>

						<li>
							<a href="inbox.html">
								查看所有消息
								<i class="icon-arrow-right"></i>
							</a>
						</li>
					</ul>
				</li>

				<!-- 第三个下拉框(登陆状态) -->
				<li class="light-blue">
					<a data-toggle="dropdown" href="#" class="dropdown-toggle">
						<img class="nav-user-photo" src="../images/user.jpg" alt="Jason's Photo" />
						<span class="user-info">
								<small>欢迎,</small>
								<span th:text="${session.USER_IN_SESSION !=null ? session.USER_IN_SESSION.user_name :'游客' }"></span>
							</span>

						<i class="icon-caret-down"></i>
					</a>

					<ul class="user-menu pull-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
						<li>
							<a href="#">
								<i class="icon-cog"></i>
								设置
							</a>
						</li>

						<li>
							<a href="#">
								<i class="icon-user"></i>
								个人资料
							</a>
						</li>

						<li class="divider"></li>

						<li>
							<a th:if="${session.USER_IN_SESSION != null }" th:href="@{/user/logout}">
								<i class="icon-off"></i>
								退出
							</a>
							<a th:if="${session.USER_IN_SESSION == null }" th:href="@{/login}">
								<i class="icon-leaf"></i>
								登陆
							</a>
						</li>
					</ul>
				</li>

			</ul><!-- /.ace-nav -->
		</div><!-- /.navbar-header -->
	</div><!-- /.container -->

	<!-- 左侧导航栏-->
	<div id="fh5co-page">
		<aside id="fh5co-aside" role="complementary" class="js-fullheight">
			<h1 id="fh5co-logo"><a href="index.html"><img src="../images/logo-colored.png" ></a></h1>
			<nav id="fh5co-main-menu" role="navigation">
				<ul>
					<li><a href="/index">首页</a></li>
					<li><a href="#">相册</a></li>
					<li class="fh5co-active">
						<a id="classifyByUserId"  href="javascript:checkLoginByClassify();" >相册分类</a>
					</li>
					<li><a href="#">关于</a></li>
				</ul>
			</nav>
			<!-- 右边底部 -->
			<div class="fh5co-footer">
				<p><small>&copy; 2017 Blend Free HTML5. All Rights Reserved.</span> More Templates <a href="#" target="_blank" title="首页">首页</a> - Collect from <a href="#" title="首页" target="_blank">首页</a></small></p>
				<ul>
					<li><a href="#"><i class="icon-facebook"></i></a></li>
					<li><a href="#"><i class="icon-twitter"></i></a></li>
					<li><a href="#"><i class="icon-instagram"></i></a></li>
					<li><a href="#"><i class="icon-linkedin"></i></a></li>
				</ul>
			</div>
		</aside>
	</div>

	<!-- 右边相册 -->
	<div id="fh5co-main">
		<div class="fh5co-narrow-content  animate-box fh5co-border-bottom" data-animate-effect="fadeInLeft">
			<span class="head-font" >个人相册</span>
			<!--<a id="addClassifyOne" th:href="@{/photo/addClassifyView}" >新增</a>-->
			<a id="addClassifyOne"  href="javascript:void(0);" onclick="checkLogin()" >新增</a>
			<br><br>

			<div class="row">
				<!-- 循环DIV -->
				<div class="col-md-4 fh5co-staff" th:each="classify : ${classifyAll}" th:id="${classify.id}">
					<img th:src="${classify.classify_coverImg}"  class="img-responsive">
					<!--<img src="../image/person2.jpg" class="img-responsive" />-->
					<h3 th:text="${classify.classify_name}"></h3>
					<h4 th:text="${classify.classify_createTime}"></h4>
					<!-- 文本域 存在适应问题 -->
					<!--<textarea rows="5" cols="44" th:text="${classify.classify_describe}" readonly></textarea>-->

					<!-- DIV模拟文本域 -->
					<div contenteditable="true" id="classifyDescribe" >
						<span th:text="${classify.classify_describe}" ></span>
					</div><br>

					<ul class="fh5co-social">
						<li>
							<!-- 修改按钮 -->
							<button type="button" id="editClassify" class="btn btn-xs btn-info" th:id="${classify.id}" onclick="editClassify(this)">
								<i class="icon-edit bigger-80"></i>
							</button>
							<!-- 删除按钮 -->
							<button type="button" id="deleteClassify" class="btn btn-xs btn-danger" th:id="${classify.id}" onclick="deleteClassify(this)">
								<i class="icon-trash bigger-80"></i>
							</button>
						</li>
					</ul>
				</div>
				<!-- 循环DIV结束 -->

			</div>
		</div>
	</div>

	<!-- 登陆模态框 -->
	<div class="modal fade" id="loginModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog" style="width: 300px">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h4 class="modal-title" id="myModalLabel">Sorry,请登陆</h4>
				</div>

				<div class="modal-body">
					<span>用户名</span><br>
					<input type="text" id="userName" ><br>
					<span>密码</span><br>
					<input type="password" id="userPassword" ><br>
					<span id="loginMsg" style="color: red"></span>
				</div>

				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
					<button type="button" id="userLogin" class="btn btn-primary">登陆</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>

	<script src="../js/jquery.min.js"></script>
	<script src="../js/jquery.easing.1.3.js"></script>
	<script src="../js/bootstrap.min.js"></script>
	<script src="../js/owl.carousel.min.js"></script>
	<script src="../js/jquery.stellar.min.js"></script>
	<script src="../js/jquery.waypoints.min.js"></script>
	<script src="../js/jquery.countTo.js"></script>
	<script src="../js/main.js"></script>

	<script th:inline="javascript">
		/* 函数名显示灰色为idea检查问题，功能正常 */
		function checkLoginByClassify() {
            var userId = [[ ${session.USER_IN_SESSION != null ? session.USER_IN_SESSION.id : null } ]];
            if(userId != null && userId != ""){
                location.href="/photo";
            }else {
				/* 模态框居中显示 */
                var $modal = $('#loginModel');
                $modal.on('show.bs.modal', function(){
                    var $this = $(this);
                    var $modal_dialog = $this.find('.modal-dialog');
                    // 关键代码，如没将modal设置为 block，则$modala_dialog.height() 为零
                    $this.css('display', 'block');
                    $modal_dialog.css({'margin-top': Math.max(0, ($(window).height() - $modal_dialog.height()) / 2) });
                });
                $modal.modal({backdrop: 'static'});
            }
        }
		
        function checkLogin() {
            var userId = [[ ${session.USER_IN_SESSION != null ? session.USER_IN_SESSION.id : null } ]];
            if(userId != null && userId != ""){
                location.href="/photo/addClassifyView";
            }else {
                /* 模态框居中显示 */
                var $modal = $('#loginModel');
                $modal.on('show.bs.modal', function(){
                    var $this = $(this);
                    var $modal_dialog = $this.find('.modal-dialog');
                    // 关键代码，如没将modal设置为 block，则$modala_dialog.height() 为零
                    $this.css('display', 'block');
                    $modal_dialog.css({'margin-top': Math.max(0, ($(window).height() - $modal_dialog.height()) / 2) });
                });
                $modal.modal({backdrop: 'static'});
            }
        }

        $("#userLogin").click(function () {
			var userName = $("#userName").val();
			var userPwd = $("#userPassword").val();
			var _data = {}
				_data.user_name = userName;
				_data.user_password = userPwd;
            $.ajax({
                url:'/user/checkLogin',
                type:'post',
                data:JSON.stringify(_data),
                contentType:'application/json',
                success:function (data) {
                    if(data.success){
                        location.href="/photo";
                    }else {
						$("#loginMsg").html("用户名或密码错误!");
                    }
                }
            });
        });

		function editClassify(obj) {
			
        }

		/* 删除相册 */
        function deleteClassify(obj) {
			var id = $(obj).attr("id");
			$.ajax({
				url:'/photo/deleteClassify/'+id,
				type:'get',
				success:function (data) {
					if(data.success){
					    alert(data.msg);
                        window.location.reload();
					}else {
					    alert(data.msg);
					}
                }
			})
//            $(location).prop('href', '/photo/deleteClassify/'+id);
        }
	</script>
</body>
</html>

